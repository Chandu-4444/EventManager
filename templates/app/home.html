{% extends "base.html" %} {% block title %} Home {% endblock %} 

{% block style %}
<style>
	.card{
		margin:  20px;
	}

  .fas{
    color: red;

  }

  

</style>


{% endblock %}

{% block content %}
{% for event in events %}
<div class="card-group">
  <div class="card">
    <img class="card-img-top" src="{{event.image.url}}" alt="Event Image" style="height: auto; width: 200px; ">
    <div class="card-body" style="display: inline-block;">
      <h5 class="card-title">{{event.title}}</h5>
      <p class="card-text">{{event.description}}</p>
      {% if event.id in liked %}
      <a class="clicked" onclick="clicked(this, '{{event.id}}')"><i class="fas fa-heart"></i></a>
      <script>
        function clicked(element, event_id)
        {
          const userName = "{{request.user.username}}";
          if(userName=="")
          {
            window.open("/login", "_self")
          }
          // console.log(element);
          // console.log(event_id);
          event_id = Number(event_id);
          console.log(event_id)
          $.ajax({
            type:'POST',
            url: "{% url 'clicked' %}",
      
            data: {
              'id': event_id,
              csrfmiddlewaretoken: '{{ csrf_token }}',
              dataType: "json",
            },
            success: function(data) {
              console.log(data)
              if(element.childNodes[0].classList.contains("fas"))
              {
                element.childNodes[0].classList.remove("fas");
                element.childNodes[0].classList.add("far");
              }
              else
              {
                element.childNodes[0].classList.remove("far");
                element.childNodes[0].classList.add("fas");
              }
            },
            error: function(err){
              console.error(err);
            }
          });
        }
       
      </script>
      {% else %}
      <a class="clicked" onclick="clicked(this, '{{event.id}}')"><i class="far fa-heart"></i></a>
      <script>
        function clicked(element, event_id)
        {
          const userName = "{{request.user.username}}";
          if(userName=="")
          {
            window.open("/login", "_self")
          }
          // console.log(element);
          // console.log(event_id);
          event_id = Number(event_id);
          console.log(event_id)
          $.ajax({
            type:'POST',
            url: "{% url 'clicked' %}",
      
            data: {
              id: event_id,
              csrfmiddlewaretoken: '{{ csrf_token }}',
              dataType: "json",
            },
            success: function(data) {
              console.log(data)
              if(element.childNodes[0].classList.contains("fas"))
              {
                element.childNodes[0].classList.remove("fas");
                element.childNodes[0].classList.add("far");
              }
              else
              {
                element.childNodes[0].classList.remove("far");
                element.childNodes[0].classList.add("fas");
              }
            },
            error: function(err){
              console.error(err);
            }
          });
        }
       
      </script>
      {% endif %}
    </div>
    <div class="card-footer">
      <small class="text-muted"> <strong>Event Timings: </strong> {{event.time}} {{event.date}} <strong>Location: </strong>{{event.location}}</small>
    </div>
  </div>
  <br>
</div>



{% endfor %}
{% endblock %}
